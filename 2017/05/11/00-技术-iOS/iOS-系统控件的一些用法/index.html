<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script>
(function(){
if(''){
if (prompt('请输入文章密码') !== ''){
alert('密码错误！');
history.back();
}
}
})();
</script>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />


















<link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=5.1.4">


<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


<link rel="mask-icon" href="/images/favicon.ico?v=5.1.4" color="#222">





<meta name="keywords" content="iOS," />










<meta name="description" content="UIViewtransform 属性CGAffineTransformMake 变换原理1@property(nonatomic) CGAffineTransform transform;   // default is CGAffineTransformIdentity. animatable">
<meta name="keywords" content="iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 系统控件的一些用法">
<meta property="og:url" content="https://liangdahong.com/2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/index.html">
<meta property="og:site_name" content="梁大红的技术Blog">
<meta property="og:description" content="UIViewtransform 属性CGAffineTransformMake 变换原理1@property(nonatomic) CGAffineTransform transform;   // default is CGAffineTransformIdentity. animatable">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2026898-88b1f7e0d9f2306e.gif?imageMogr2/auto-orient/strip ">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1983862-0efd712269e9a75c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-10-18T23:09:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 系统控件的一些用法">
<meta name="twitter:description" content="UIViewtransform 属性CGAffineTransformMake 变换原理1@property(nonatomic) CGAffineTransform transform;   // default is CGAffineTransformIdentity. animatable">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/2026898-88b1f7e0d9f2306e.gif?imageMogr2/auto-orient/strip ">



<script type="text/javascript" id="hexo.configurations">
var NexT = window.NexT || {};
var CONFIG = {
root: '/',
scheme: 'Pisces',
version: '5.1.4',
sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
fancybox: true,
tabs: true,
motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
duoshuo: {
userId: '0',
author: '博主'
},
algolia: {
applicationID: '',
apiKey: '',
indexName: '',
hits: {"per_page":10},
labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
}
};
</script>



<link rel="canonical" href="https://liangdahong.com/2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/"/>






  <title>iOS 系统控件的一些用法 | 梁大红的技术Blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cfc3472238e91bbaf9532f7d54b9ff7c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

<a href="https://github.com/liangdahong"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">梁大红的技术Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-00-技术-ios">
          <a href="/categories/00-技术-iOS" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            00-技术-iOS
          </a>
        </li>
      
        
        <li class="menu-item menu-item-01-技术-微信小程序">
          <a href="/categories/01-技术-微信小程序" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            01-技术-微信小程序
          </a>
        </li>
      
        
        <li class="menu-item menu-item-02-技术-前端">
          <a href="/categories/02-技术-前端" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            02-技术-前端
          </a>
        </li>
      
        
        <li class="menu-item menu-item-03-技术-计算机">
          <a href="/categories/03-技术-计算机" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            03-技术-计算机
          </a>
        </li>
      
        
        <li class="menu-item menu-item-04-技术-hexo">
          <a href="/categories/04-技术-Hexo" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            04-技术-Hexo
          </a>
        </li>
      
        
        <li class="menu-item menu-item-05-生活-感叹">
          <a href="/categories/05-生活-感叹" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eercast"></i> <br />
            
            05-生活-感叹
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liangdahong.com/2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="梁大红">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="梁大红的技术Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">iOS 系统控件的一些用法</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-11T23:26:19+08:00">
                2017-05-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/00-技术-iOS/" itemprop="url" rel="index">
                    <span itemprop="name">00-技术-iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="UIView"><a href="#UIView" class="headerlink" title="UIView"></a>UIView</h1><h2 id="transform-属性"><a href="#transform-属性" class="headerlink" title="transform 属性"></a>transform 属性</h2><h3 id="CGAffineTransformMake-变换原理"><a href="#CGAffineTransformMake-变换原理" class="headerlink" title="CGAffineTransformMake 变换原理"></a>CGAffineTransformMake 变换原理</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic) CGAffineTransform transform;   <span class="comment">// default is CGAffineTransformIdentity. animatable</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<ul>
<li>当我们使用 <code>CGAffineTransformMake</code> 方法时实际是创建一个<br><code>CGAffineTransform</code>的结构体,此结构体定义如下：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CGAffineTransform</span> &#123;</span></span><br><span class="line">  CGFloat a, b, c, d;</span><br><span class="line">  CGFloat tx, ty;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMake</span><span class="params">(CGFloat a, CGFloat b,</span></span></span><br><span class="line"><span class="function"><span class="params">  CGFloat c, CGFloat d, CGFloat tx, CGFloat ty)</span></span></span><br><span class="line"><span class="function">  <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>其中<code>a`</code> b <code>c</code>d <code>tx</code>ty<code>可以组成如下</code>3X3` 的矩阵，如下：   </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">B = </span><br><span class="line"> [           ]</span><br><span class="line">    a  b  <span class="number">0</span></span><br><span class="line">    c  d  <span class="number">0</span></span><br><span class="line">    tx ty <span class="number">1</span></span><br><span class="line"> [           ]</span><br></pre></td></tr></table></figure>
<ul>
<li>当使用 <code>Transform</code> 变换时实际是把<code>view</code>上所有的点通过 <code>矩阵B</code>计算得新的点。假设 <code>view</code>上一点</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A = [x y <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>A * B 可以得到变换后的点</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A` = [(a*x+c*y+tx) (b*x+d*y+ty) (<span class="number">1</span>) ]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中的 矩阵 * 矩阵 的计算可参考大学 <code>线性代数</code><br>使用给不同的字值自然可以达到不同效果</p>
</blockquote>
<ul>
<li><p>其中<code>Apple</code>封装了一些常用的方法,包括：<br> <code>平移（Translation）</code><br>  <code>缩放（Scale）</code><br>  <code>旋转（Rotation）</code><br>  <code>剪切（Shear）</code><br>  <code>翻转（Flip）</code></p>
</li>
<li><p>平移（Translation)</p>
<blockquote>
<p>由上面的计算可以得到 当 </p>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line">d = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>时 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A` = [(x+tx) (y+ty) (<span class="number">1</span>) ]</span><br></pre></td></tr></table></figure>
<p>使用<br><code>CGAffineTransformMake(1, 0, 0, 1, tx, ty);</code>即可。<br>系统提供了类似的方法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Return a transform which translates by `(tx, ty)':</span></span><br><span class="line"><span class="comment">     t' = [ 1 0 0 1 tx ty ] */</span></span><br><span class="line"></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMakeTranslation</span><span class="params">(CGFloat tx,</span></span></span><br><span class="line"><span class="function"><span class="params">  CGFloat ty)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>由<code>Apple</code>注释可以发现前面的分析正确,那么其他的种类已基本一个思路。</p>
</blockquote>
<p><a href="http://liuyanwei.jumppo.com/2015/11/24/iOS-affine-transfermation-animation.html" target="_blank" rel="noopener">参考</a></p>
<blockquote>
<p>此属性主要是用来操作UIView的平移，旋转，伸缩。</p>
</blockquote>
<ul>
<li><p>CGAffineTransformIdentity （默认。当我们想恢复原始状态时可以使用此方法）</p>
</li>
<li><p>CGAffineTransformMakeRotation 旋转</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[UIView animateWithDuration:<span class="number">0.3</span> animations:^&#123;</span><br><span class="line">    <span class="comment">//  0 &lt; x &lt;= M_PI 顺时针旋转</span></span><br><span class="line">    <span class="comment">// -M_PI &lt;= x &lt; 0 逆时针旋转</span></span><br><span class="line">    <span class="comment">// 总结：总是以最近，尽量顺时针，最多旋转180°的方式到达目的地</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(M_PI);  // 顺时针旋转 180°</span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(M_PI_2); // 顺时针旋转 90°</span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(M_PI_4); // 顺时针旋转 45°</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(-M_PI); // 逆时针旋转 180°</span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(-M_PI_2); // 逆时针旋转 90°</span></span><br><span class="line"><span class="comment">     self.myView.transform = CGAffineTransformMakeRotation(-M_PI_4); // 逆时针旋转 45°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    self.myView.transform = CGAffineTransformMakeRotation(M_PI * <span class="number">1.5</span>); <span class="comment">// 逆时针旋转 90°</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<ul>
<li>演示如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2026898-88b1f7e0d9f2306e.gif?imageMogr2/auto-orient/strip " width="70%"></p>
<ul>
<li>CGAffineTransformMakeScale 伸缩</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[UIView animateWithDuration:<span class="number">0.3</span> animations:^&#123;</span><br><span class="line">    <span class="comment">// 宽高伸缩比例</span></span><br><span class="line">    <span class="comment">// 宽变为 sx * width</span></span><br><span class="line">    <span class="comment">// 高变为 sy * height</span></span><br><span class="line">    self.myView.transform = CGAffineTransformMakeScale(<span class="number">0.6</span>, <span class="number">0.5</span>); <span class="comment">// 宽变为 0.6 * height  高变为 0.5 * height</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<ul>
<li>CGAffineTransformMakeTranslation 平移操作</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[UIView animateWithDuration:<span class="number">0.3</span> animations:^&#123;</span><br><span class="line">    <span class="comment">// xy移动距离</span></span><br><span class="line">    <span class="comment">// x变为 x + tx</span></span><br><span class="line">    <span class="comment">// y变为 y + ty</span></span><br><span class="line">    self.myView.transform = CGAffineTransformMakeTranslation(<span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">	&#125;];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<h3 id="系统API说明"><a href="#系统API说明" class="headerlink" title="系统API说明"></a>系统API说明</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 结构体</span></span><br><span class="line"><span class="comment"> B = [            ]</span></span><br><span class="line"><span class="comment">        a  b  0</span></span><br><span class="line"><span class="comment">        c  d  0</span></span><br><span class="line"><span class="comment">        tx ty 1</span></span><br><span class="line"><span class="comment">     [            ]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> view 上所有点经过 变换为 A`,变换为 * B</span></span><br><span class="line"><span class="comment">  A(X,Y,1) * B = A`([(a*x+c*y+tx),(b*x+d*y+ty),(1))</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CGAffineTransform</span> &#123;</span></span><br><span class="line">    CGFloat a, b, c, d;</span><br><span class="line">    CGFloat tx, ty;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* The identity transform: [ 1 0 0 1 0 0 ]. */</span></span><br><span class="line"><span class="comment">// [(a*x+c*y+tx) (b*x+d*y+ty) (1) ] --&gt; [(x) (y) (1) ] 还原初始位置</span></span><br><span class="line"><span class="comment">// 还原初始状态</span></span><br><span class="line">CG_EXTERN <span class="keyword">const</span> CGAffineTransform CGAffineTransformIdentity</span><br><span class="line">CG_AVAILABLE_STARTING(__MAC_10_0, __IPHONE_2_0);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return the transform [ a b c d tx ty ]. */</span></span><br><span class="line"><span class="comment">// [(a*x+c*y+tx) (b*x+d*y+ty) (1) ] --&gt; [(a*x+c*y+tx) (b*x+d*y+ty) (1) ]</span></span><br><span class="line"><span class="comment">// 自定义形变</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMake</span><span class="params">(CGFloat a, CGFloat b,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                  CGFloat c, CGFloat d, CGFloat tx, CGFloat ty)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return a transform which translates by `(tx, ty)':</span></span><br><span class="line"><span class="comment"> t' = [ 1 0 0 1 tx ty ] */</span></span><br><span class="line"><span class="comment">// [(a*x+c*y+tx) (b*x+d*y+ty) (1) ] --&gt; [(x+tx) (y+ty) (1) ] 平移</span></span><br><span class="line"><span class="comment">// 平移</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMakeTranslation</span><span class="params">(CGFloat tx,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                             CGFloat ty)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return a transform which scales by `(sx, sy)':</span></span><br><span class="line"><span class="comment"> t' = [ sx 0 0 sy 0 0 ] */</span></span><br><span class="line"><span class="comment">// [(a*x+c*y+tx) (b*x+d*y+ty) (1) ] --&gt; [(sx*x) (sy*y) (1) ]</span></span><br><span class="line"><span class="comment">// 缩放</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMakeScale</span><span class="params">(CGFloat sx, CGFloat sy)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return a transform which rotates by `angle' radians:</span></span><br><span class="line"><span class="comment"> t' = [ cos(angle) sin(angle) -sin(angle) cos(angle) 0 0 ] */</span></span><br><span class="line"><span class="comment">// 旋转</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformMakeRotation</span><span class="params">(CGFloat angle)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return true if `t' is the identity transform, false otherwise. */</span></span><br><span class="line"><span class="comment">// 是否为初始值</span></span><br><span class="line"><span class="function">CG_EXTERN <span class="keyword">bool</span> <span class="title">CGAffineTransformIsIdentity</span><span class="params">(CGAffineTransform t)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_4, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Translate `t' by `(tx, ty)' and return the result:</span></span><br><span class="line"><span class="comment"> t' = [ 1 0 0 1 tx ty ] * t */</span></span><br><span class="line"><span class="comment">// 在 t' 的状态下发生下一次变换平移</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformTranslate</span><span class="params">(CGAffineTransform t,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                       CGFloat tx, CGFloat ty)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Scale `t' by `(sx, sy)' and return the result:</span></span><br><span class="line"><span class="comment"> t' = [ sx 0 0 sy 0 0 ] * t */</span></span><br><span class="line"><span class="comment">// 在 t' 的状态下发生下一次变换 缩放</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformScale</span><span class="params">(CGAffineTransform t,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                   CGFloat sx, CGFloat sy)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Rotate `t' by `angle' radians and return the result:</span></span><br><span class="line"><span class="comment"> t' =  [ cos(angle) sin(angle) -sin(angle) cos(angle) 0 0 ] * t */</span></span><br><span class="line"><span class="comment">// 在 t' 的状态下发生下一次变换 旋转</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformRotate</span><span class="params">(CGAffineTransform t,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                    CGFloat angle)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Invert `t' and return the result. If `t' has zero determinant, then `t'</span></span><br><span class="line"><span class="comment"> is returned unchanged. */</span></span><br><span class="line"><span class="comment">// 对t 反向旋转</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformInvert</span><span class="params">(CGAffineTransform t)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Concatenate `t2' to `t1' and return the result:</span></span><br><span class="line"><span class="comment"> t' = t1 * t2 */</span></span><br><span class="line"><span class="comment">// 组合 t1  t2</span></span><br><span class="line"><span class="function">CG_EXTERN CGAffineTransform <span class="title">CGAffineTransformConcat</span><span class="params">(CGAffineTransform t1,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                    CGAffineTransform t2)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Return true if `t1' and `t2' are equal, false otherwise. */</span></span><br><span class="line"><span class="comment">// 判断是否相同</span></span><br><span class="line"><span class="function">CG_EXTERN <span class="keyword">bool</span> <span class="title">CGAffineTransformEqualToTransform</span><span class="params">(CGAffineTransform t1,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 CGAffineTransform t2)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_4, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Transform `point' by `t' and return the result:</span></span><br><span class="line"><span class="comment"> p' = p * t</span></span><br><span class="line"><span class="comment"> where p = [ x y 1 ]. */</span></span><br><span class="line"><span class="comment">// 得到新的中心CGPoint (没用过)</span></span><br><span class="line"><span class="function">CG_EXTERN CGPoint <span class="title">CGPointApplyAffineTransform</span><span class="params">(CGPoint point,</span></span></span><br><span class="line"><span class="function"><span class="params">                                              CGAffineTransform t)</span> <span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Transform `size' by `t' and return the result:</span></span><br><span class="line"><span class="comment"> s' = s * t</span></span><br><span class="line"><span class="comment"> where s = [ width height 0 ]. */</span></span><br><span class="line"><span class="comment">// 得到新的size CGSize (没用过)</span></span><br><span class="line"><span class="function">CG_EXTERN CGSize <span class="title">CGSizeApplyAffineTransform</span><span class="params">(CGSize size, CGAffineTransform t)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_0, __IPHONE_2_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Transform `rect' by `t' and return the result. Since affine transforms do</span></span><br><span class="line"><span class="comment"> not preserve rectangles in general, this function returns the smallest</span></span><br><span class="line"><span class="comment"> rectangle which contains the transformed corner points of `rect'. If `t'</span></span><br><span class="line"><span class="comment"> consists solely of scales, flips and translations, then the returned</span></span><br><span class="line"><span class="comment"> rectangle coincides with the rectangle constructed from the four</span></span><br><span class="line"><span class="comment"> transformed corners. */</span></span><br><span class="line"><span class="comment">// 得到新的rect CGRect (没用过)</span></span><br><span class="line"><span class="function">CG_EXTERN CGRect <span class="title">CGRectApplyAffineTransform</span><span class="params">(CGRect rect, CGAffineTransform t)</span></span></span><br><span class="line"><span class="function"><span class="title">CG_AVAILABLE_STARTING</span><span class="params">(__MAC_10_4, __IPHONE_2_0)</span></span>;</span><br></pre></td></tr></table></figure>
<h1 id="UIScrollView"><a href="#UIScrollView" class="headerlink" title="UIScrollView"></a>UIScrollView</h1><h2 id="UIScrollView-1"><a href="#UIScrollView-1" class="headerlink" title="UIScrollView"></a>UIScrollView</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic)         CGPoint                      contentOffset;                  <span class="comment">// default CGPointZero 当前滚动到的位置</span></span><br><span class="line">@property(nonatomic)         CGSize                       contentSize;                    <span class="comment">// default CGSizeZero 滚动范围</span></span><br><span class="line">@property(nonatomic)         UIEdgeInsets                 contentInset;                   <span class="comment">// default UIEdgeInsetsZero. add additional scroll area around content 额外增加的滚动范围</span></span><br><span class="line">@property(nullable,nonatomic,weak) id&lt;UIScrollViewDelegate&gt;        delegate;                       <span class="comment">// default nil. weak reference 代理</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// default NO. if YES, try to lock vertical or horizontal scrolling while dragging</span></span><br><span class="line"><span class="comment">// 方向锁定（在一个方向滚动时 另一个方向不允许滚动）</span></span><br><span class="line">@property(nonatomic,getter=isDirectionalLockEnabled) BOOL directionalLockEnabled;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default YES. if YES, bounces past edge of content and back again 弹簧效果</span></span><br><span class="line">@property(nonatomic)         BOOL                         bounces;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default NO. if YES and bounces is YES, even if content is smaller than bounds, allow drag vertically</span></span><br><span class="line"><span class="comment">// 垂直方向的弹簧效果</span></span><br><span class="line">@property(nonatomic)         BOOL                         alwaysBounceVertical;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default NO. if YES and bounces is YES, even if content is smaller than bounds, allow drag horizontally</span></span><br><span class="line"><span class="comment">// 水平方向的弹簧效果</span></span><br><span class="line">@property(nonatomic)         BOOL                         alwaysBounceHorizontal;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default NO. if YES, stop on multiples of view bounds</span></span><br><span class="line"><span class="comment">// 启动分页</span></span><br><span class="line">@property(nonatomic,getter=isPagingEnabled) BOOL          pagingEnabled __TVOS_PROHIBITED;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default YES. turn off any dragging temporarily</span></span><br><span class="line"><span class="comment">// 是否可以拖动</span></span><br><span class="line">@property(nonatomic,getter=isScrollEnabled) BOOL          scrollEnabled;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default YES. show indicator while we are tracking. fades out after tracking</span></span><br><span class="line"><span class="comment">// 是否显示水平滚动条</span></span><br><span class="line">@property(nonatomic)         BOOL                         showsHorizontalScrollIndicator;</span><br><span class="line"><span class="comment">// default YES. show indicator while we are tracking. fades out after tracking</span></span><br><span class="line"><span class="comment">// 是否显示垂直滚动条</span></span><br><span class="line">@property(nonatomic)         BOOL                         showsVerticalScrollIndicator;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default is UIEdgeInsetsZero. adjust indicators inside of insets</span></span><br><span class="line"><span class="comment">// 调整滚动显示器的边距</span></span><br><span class="line">@property(nonatomic)         UIEdgeInsets                 scrollIndicatorInsets;</span><br><span class="line"></span><br><span class="line"><span class="comment">// default is UIScrollViewIndicatorStyleDefault</span></span><br><span class="line"><span class="comment">// scrollView 的样式</span></span><br><span class="line">@property(nonatomic)         UIScrollViewIndicatorStyle   indicatorStyle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UIKIT_EXTERN const CGFloat UIScrollViewDecelerationRateNormal NS_AVAILABLE_IOS(3_0);</span></span><br><span class="line"><span class="comment">// UIKIT_EXTERN const CGFloat UIScrollViewDecelerationRateFast NS_AVAILABLE_IOS(3_0);</span></span><br><span class="line"><span class="comment">// 滚动的速度</span></span><br><span class="line">@property(nonatomic)         <span class="function">CGFloat                      decelerationRate <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tvos 上使用</span></span><br><span class="line">@property(nonatomic)         UIScrollViewIndexDisplayMode indexDisplayMode API_AVAILABLE(tvos(10.2));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置滚动的位置 是否动画</span></span><br><span class="line">- (<span class="keyword">void</span>)setContentOffset:(CGPoint)contentOffset animated:(BOOL)animated;  <span class="comment">// animate at constant velocity to new offset</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 滚动到具体位置</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollRectToVisible:(CGRect)rect animated:(BOOL)animated;         <span class="comment">// scroll so rect is just visible (nearest edges). nothing if rect completely visible</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 让滚动条显示（但只会显示一段时间会自动隐藏 可以使用分类重写imageView的 alpha 方法来控制，因为scroll的滚动条是 imageView）</span></span><br><span class="line">- (<span class="keyword">void</span>)flashScrollIndicators;             <span class="comment">// displays the scroll indicators for a short time. This should be done whenever you bring the scroll view to front.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Scrolling with no scroll bars is a bit complex. on touch down, we don't know if the user will want to scroll or track a subview like a control.</span></span><br><span class="line"><span class="comment"> on touch down, we start a timer and also look at any movement. if the time elapses without sufficient change in position, we start sending events to</span></span><br><span class="line"><span class="comment"> the hit view in the content subview. if the user then drags far enough, we switch back to dragging and cancel any tracking in the subview.</span></span><br><span class="line"><span class="comment"> the methods below are called by the scroll view and give subclasses override points to add in custom behaviour.</span></span><br><span class="line"><span class="comment"> you can remove the delay in delivery of touchesBegan:withEvent: to subviews by setting delaysContentTouches to NO.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否正在跟踪</span></span><br><span class="line">@property(nonatomic,readonly,getter=isTracking)     BOOL tracking;        <span class="comment">// returns YES if user has touched. may not yet have started dragging</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否正在拖拽</span></span><br><span class="line">@property(nonatomic,readonly,getter=isDragging)     BOOL dragging;        <span class="comment">// returns YES if user has started scrolling. this may require some time and or distance to move to initiate dragging</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否正在减速</span></span><br><span class="line">@property(nonatomic,readonly,getter=isDecelerating) BOOL decelerating;    <span class="comment">// returns YES if user isn't dragging (touch up) but scroll view is still moving</span></span><br><span class="line"></span><br><span class="line">@property(nonatomic) BOOL delaysContentTouches;       <span class="comment">// default is YES. if NO, we immediately call -touchesShouldBegin:withEvent:inContentView:. this has no effect on presses</span></span><br><span class="line">@property(nonatomic) BOOL canCancelContentTouches;    <span class="comment">// default is YES. if NO, then once we start tracking, we don't try to drag if the touch moves. this has no effect on presses</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// override points for subclasses to control delivery of touch events to subviews of the scroll view</span></span><br><span class="line"><span class="comment">// called before touches are delivered to a subview of the scroll view. if it returns NO the touches will not be delivered to the subview</span></span><br><span class="line"><span class="comment">// this has no effect on presses</span></span><br><span class="line"><span class="comment">// default returns YES</span></span><br><span class="line">- (BOOL)touchesShouldBegin:(NSSet&lt;UITouch *&gt; *)touches withEvent:(nullable UIEvent *)event inContentView:(UIView *)view;</span><br><span class="line"><span class="comment">// called before scrolling begins if touches have already been delivered to a subview of the scroll view. if it returns NO the touches will continue to be delivered to the subview and scrolling will not occur</span></span><br><span class="line"><span class="comment">// not called if canCancelContentTouches is NO. default returns YES if view isn't a UIControl</span></span><br><span class="line"><span class="comment">// this has no effect on presses</span></span><br><span class="line">- (BOOL)touchesShouldCancelInContentView:(UIView *)view;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> the following properties and methods are for zooming. as the user tracks with two fingers, we adjust the offset and the scale of the content. When the gesture ends, you should update the content</span></span><br><span class="line"><span class="comment"> as necessary. Note that the gesture can end and a finger could still be down. While the gesture is in progress, we do not send any tracking calls to the subview.</span></span><br><span class="line"><span class="comment"> the delegate must implement both viewForZoomingInScrollView: and scrollViewDidEndZooming:withView:atScale: in order for zooming to work and the max/min zoom scale must be different</span></span><br><span class="line"><span class="comment"> note that we are not scaling the actual scroll view but the 'content view' returned by the delegate. the delegate must return a subview, not the scroll view itself, from viewForZoomingInScrollview:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">@property(nonatomic) CGFloat minimumZoomScale;     <span class="comment">// default is 1.0</span></span><br><span class="line">@property(nonatomic) CGFloat maximumZoomScale;     <span class="comment">// default is 1.0. must be &gt; minimum zoom scale to enable zooming</span></span><br><span class="line"></span><br><span class="line">@property(nonatomic) <span class="function">CGFloat zoomScale <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_0)</span></span>;            <span class="comment">// default is 1.0</span></span><br><span class="line">- (<span class="keyword">void</span>)setZoomScale:(CGFloat)scale animated:(BOOL)<span class="function">animated <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_0)</span></span>;</span><br><span class="line">- (<span class="keyword">void</span>)zoomToRect:(CGRect)rect animated:(BOOL)<span class="function">animated <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_0)</span></span>;</span><br><span class="line"></span><br><span class="line">@property(nonatomic) BOOL  bouncesZoom;          <span class="comment">// default is YES. if set, user can go past min/max zoom while gesturing and the zoom will animate to the min/max value at gesture end</span></span><br><span class="line"></span><br><span class="line">@property(nonatomic,readonly,getter=isZooming)       BOOL zooming;       <span class="comment">// returns YES if user in zoom gesture</span></span><br><span class="line">@property(nonatomic,readonly,getter=isZoomBouncing)  BOOL zoomBouncing;  <span class="comment">// returns YES if we are in the middle of zooming back to the min/max value</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// When the user taps the status bar, the scroll view beneath the touch which is closest to the status bar will be scrolled to top, but only if its `scrollsToTop` property is YES, its delegate does not return NO from `shouldScrollViewScrollToTop`, and it is not already at the top.</span></span><br><span class="line"><span class="comment">// On iPhone, we execute this gesture only if there's one on-screen scroll view with `scrollsToTop` == YES. If more than one is found, none will be scrolled.</span></span><br><span class="line">@property(nonatomic) BOOL  scrollsToTop __TVOS_PROHIBITED;          <span class="comment">// default is YES.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use these accessors to configure the scroll view's built-in gesture recognizers.</span></span><br><span class="line"><span class="comment">// Do not change the gestures' delegates or override the getters for these properties.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Change `panGestureRecognizer.allowedTouchTypes` to limit scrolling to a particular set of touch types.</span></span><br><span class="line">@property(nonatomic, readonly) <span class="function">UIPanGestureRecognizer *panGestureRecognizer <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">5</span>_0)</span></span>;</span><br><span class="line"><span class="comment">// `pinchGestureRecognizer` will return nil when zooming is disabled.</span></span><br><span class="line">@property(nullable, nonatomic, readonly) <span class="function">UIPinchGestureRecognizer *pinchGestureRecognizer <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">5</span>_0)</span></span>;</span><br><span class="line"><span class="comment">// `directionalPressGestureRecognizer` is disabled by default, but can be enabled to perform scrolling in response to up / down / left / right arrow button presses directly, instead of scrolling indirectly in response to focus updates.</span></span><br><span class="line">@property(nonatomic, readonly) <span class="function">UIGestureRecognizer *directionalPressGestureRecognizer <span class="title">UIKIT_AVAILABLE_TVOS_ONLY</span><span class="params">(<span class="number">9</span>_0)</span></span>;</span><br><span class="line"></span><br><span class="line">@property(nonatomic) <span class="function">UIScrollViewKeyboardDismissMode keyboardDismissMode <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">7</span>_0)</span></span>; <span class="comment">// default is UIScrollViewKeyboardDismissModeNone</span></span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, nullable) <span class="function">UIRefreshControl *refreshControl <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">10</span>_0)</span> __TVOS_PROHIBITED</span>;</span><br></pre></td></tr></table></figure>
<h2 id="UIScrollViewDelegate"><a href="#UIScrollViewDelegate" class="headerlink" title="UIScrollViewDelegate"></a>UIScrollViewDelegate</h2><ul>
<li><a href="http://www.jianshu.com/p/5391997cbdd2" target="_blank" rel="noopener">参考http://www.jianshu.com/p/5391997cbdd2</a></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正在滚动时 scrollViewDidScroll</span></span><br><span class="line"><span class="comment">// any offset changes</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(UIScrollView *)scrollView;                                               </span><br><span class="line"></span><br><span class="line"><span class="comment">// 正在缩放时 scrollViewDidZoom</span></span><br><span class="line"><span class="comment">// any zoom scale changes</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidZoom:(UIScrollView *)<span class="function">scrollView <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_2)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 将要开始拖拽时（一次有效拖拽）手刚接触到scroll时 scrollViewWillBeginDragging</span></span><br><span class="line"><span class="comment">// called on start of dragging (may require some time and or distance to move)</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDragging:(UIScrollView *)scrollView;</span><br><span class="line"></span><br><span class="line"><span class="comment">// called on finger up if the user dragged. velocity is in points/millisecond. </span></span><br><span class="line"><span class="comment">// targetContentOffset may be changed to adjust where the scroll view comes to rest</span></span><br><span class="line"><span class="comment">// 就要结束拖拽时 手将要离开scroll时 scrollViewWillEndDragging  velocity当前的速度  </span></span><br><span class="line"><span class="comment">// targetContentOffset此次滚动结束的目标偏远</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity </span><br><span class="line">    targetContentOffset:(inout CGPoint *)<span class="function">targetContentOffset <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">5</span>_0)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// called on finger up if the user dragged. decelerate is true if it will continue moving afterwards</span></span><br><span class="line"><span class="comment">// 已经结束拖拽时 手刚离开scroll时 scrollViewDidEndDragging  decelerate是否会继续向前滚动一段距离</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate;</span><br><span class="line"></span><br><span class="line"><span class="comment">// called on finger up as we are moving</span></span><br><span class="line"><span class="comment">// 将要开始减速时 手刚离开时</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView;   </span><br><span class="line"></span><br><span class="line"><span class="comment">// called when scroll view grinds to a halt</span></span><br><span class="line"><span class="comment">// 已经结束减速时 停下来时</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDecelerating:(UIScrollView *)scrollView;     </span><br><span class="line"></span><br><span class="line"><span class="comment">// // called when setContentOffset/scrollRectVisible:animated: finishes. not called if not animating</span></span><br><span class="line"><span class="comment">// 已经滚动滚动（使用代码设置的滚动时）</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView; </span><br><span class="line"><span class="comment">// return a view that will be scaled. if delegate returns nil, nothing happens</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回需要缩放的view</span></span><br><span class="line">- (nullable UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView;   </span><br><span class="line"></span><br><span class="line"><span class="comment">// called before the scroll view begins zooming its content</span></span><br><span class="line"><span class="comment">// 将要开始缩放</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginZooming:(UIScrollView *)scrollView withView:(nullable UIView *)<span class="function">view <span class="title">NS_AVAILABLE_IOS</span><span class="params">(<span class="number">3</span>_2)</span></span>; </span><br><span class="line"> </span><br><span class="line"><span class="comment">// scale between minimum and maximum. called after any 'bounce' animations</span></span><br><span class="line"><span class="comment">// 已结束缩放  view缩放的view  scale缩放比例</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(nullable UIView *)view atScale:(CGFloat)scale; </span><br><span class="line"></span><br><span class="line"><span class="comment">// return a yes if you want to scroll to the top. if not defined, assumes YES</span></span><br><span class="line"><span class="comment">// 点击状态栏时是否可以返回顶部</span></span><br><span class="line">- (BOOL)scrollViewShouldScrollToTop:(UIScrollView *)scrollView;   </span><br><span class="line"></span><br><span class="line"><span class="comment">// called when scrolling animation finished. may be called immediately if already at top</span></span><br><span class="line"><span class="comment">// 点击状态栏后回到顶部结束</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScrollToTop:(UIScrollView *)scrollView;</span><br></pre></td></tr></table></figure>
<h1 id="iOS沙盒"><a href="#iOS沙盒" class="headerlink" title="iOS沙盒"></a>iOS沙盒</h1><h2 id="沙盒目录"><a href="#沙盒目录" class="headerlink" title="沙盒目录"></a>沙盒目录</h2><p><code>NSString *homeDirectory =  NSHomeDirectory();</code></p>
<ul>
<li>home/Documents</li>
</ul>
<blockquote>
<p><code>NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0]</code></p>
<p>①存放内容 我们可以将应用程序的数据文件保存在该目录下。不过这些数据类型仅限于不可再生的数据，可再生的数据文件应该存放在Library/Cache目录下。</p>
<p>②会被iTunes同步</p>
</blockquote>
<ul>
<li>home/Library/Caches</li>
</ul>
<blockquote>
<p><code>NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES)[0]</code></p>
<p>①存放内容主要是缓存文件，用户使用过程中缓存都可以保存在这个目录中。前面说过，Documents目录用于保存不可再生的文件，那么这个目录就用于保存那些可再生的文件，比如网络请求的数据。鉴于此，应用程序通常还需要负责删除这些文件,注意：存储不足时，系统会清理此文件夹。</p>
<p>②不会被iTunes同步</p>
</blockquote>
<ul>
<li><p>home/Library/Preferences</p>
<blockquote>
<p><code>[NSSearchPathForDirectoriesInDomains(NSLibraryDirectory,NSUserDomainMask,YES)[0] stringByAppendingPathComponent:@&quot;Preferences&quot;];</code></p>
<p>①存放内容应用程序的偏好设置文件。我们使用NSUserDefaults写的设置数据都会保存到该目录下的一个plist文件中，这就是所谓的写道plist中！</p>
<p>②会被iTunes同步</p>
</blockquote>
</li>
</ul>
<ul>
<li>home/tmp</li>
</ul>
<blockquote>
<p><code>NSTemporaryDirectory();</code></p>
<p>存储放临时文件，退出App后自动删除  ，可以任意操作此文件夹,不会被iTunes同步</p>
</blockquote>
<ul>
<li><p>home/MyApp.app</p>
<blockquote>
<p><code>[[NSBundle mainBundle] bundlePath]</code></p>
<p>①存放内容该目录包含了应用程序本身的数据，包括资源文件和可执行文件等。程序启动以后，会根据需要从该目录中动态加载代码或资源到内存，这里用到了lazy loading的思想。</p>
<p>②整个目录是只读的为了防止被篡改，应用在安装的时候会将该目录签名。非越狱情况下，该目录中内容是无法更改的；在越狱设备上如果更改了目录内容，对应的签名就会被改变，这种情况下苹果官网描述的后果是应用程序将无法启动，我没实践过。</p>
<p>③不会被iTunes同步</p>
</blockquote>
</li>
</ul>
<h1 id="appearance"><a href="#appearance" class="headerlink" title="appearance"></a>appearance</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置 UINavigationBar 上的 item 的颜色，包括 item 和 backItem</span></span><br><span class="line">[UINavigationBar appearance].tintColor= [UIColor redColor];</span><br><span class="line"><span class="comment">// 设置 UINavigationBar 的背景颜色</span></span><br><span class="line">[UINavigationBar appearance].barTintColor = [UIColor blueColor];</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 设置 UINavigationBar 上的标题的属性</span></span><br><span class="line">[UINavigationBar appearance].titleTextAttributes =</span><br><span class="line">@&#123;</span><br><span class="line">NSFontAttributeName: [UIFont boldSystemFontOfSize:<span class="number">40</span>],</span><br><span class="line">NSForegroundColorAttributeName : [UIColor whiteColor],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 设置 UITabBar 上的 item 的颜色</span></span><br><span class="line">[UITabBar appearance].tintColor = [UIColor redColor];</span><br><span class="line"><span class="comment">// 设置 UITabBar 的背景颜色</span></span><br><span class="line">[UITabBar appearance].barTintColor = [UIColor blueColor];</span><br></pre></td></tr></table></figure>
<h1 id="AFN"><a href="#AFN" class="headerlink" title="AFN"></a>AFN</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];</span><br><span class="line">    </span><br><span class="line">&#123;</span><br><span class="line">    // 请求格式化</span><br><span class="line">    manager.requestSerializer =  [AFJSONRequestSerializer serializer];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    // 响应</span><br><span class="line">    AFHTTPResponseSerializer *serializer=[AFHTTPResponseSerializer serializer];</span><br><span class="line">    serializer.acceptableContentTypes = [NSSet setWithObjects:@&quot;text/html&quot;,</span><br><span class="line">                                         @&quot;application/json&quot;,</span><br><span class="line">                                         @&quot;text/json&quot; ,</span><br><span class="line">                                         @&quot;text/javascript&quot;,</span><br><span class="line">                                         @&quot;video/mp4&quot;, nil];</span><br><span class="line">    manager.responseSerializer = serializer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="保存图片到相册"><a href="#保存图片到相册" class="headerlink" title="保存图片到相册"></a>保存图片到相册</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (void)loadImageFinished:(UIImage *)image</span><br><span class="line">&#123;</span><br><span class="line">    UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), (__bridge void *)self);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)image:(UIImage *)image didFinishSavingWithError:(NSError *)error contextInfo:(void *)contextInfo</span><br><span class="line">&#123;</span><br><span class="line">    [MEMEITUOKHUD dismiss];</span><br><span class="line">    if (error) &#123;</span><br><span class="line">        UIAlertController *alertVC = [UIAlertController alertControllerWithTitle:@&quot;保存失败&quot; message:error.domain preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line">        [alertVC addAction:[UIAlertAction actionWithTitle:@&quot;OK&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">        &#125;]];</span><br><span class="line">        [self presentViewController:alertVC animated:YES completion:nil];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        UIAlertController *alertVC = [UIAlertController alertControllerWithTitle:@&quot;保存成功&quot; message:nil preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line">        [alertVC addAction:[UIAlertAction actionWithTitle:@&quot;OK&quot; style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">        &#125;]];</span><br><span class="line">        [self presentViewController:alertVC animated:YES completion:nil];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="显示模式-UIViewContentMode"><a href="#显示模式-UIViewContentMode" class="headerlink" title="显示模式 UIViewContentMode"></a>显示模式 UIViewContentMode</h1><p><img src="https://upload-images.jianshu.io/upload_images/1983862-0efd712269e9a75c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSInteger, UIViewContentMode) &#123;</span><br><span class="line"></span><br><span class="line">    // 图片强行变形缩放显示满 UIImageView 为止</span><br><span class="line">    UIViewContentModeScaleToFill,</span><br><span class="line">    </span><br><span class="line">    // 图片等比例缩放到完全显示到内部，而且保证最少有一边填满 UIImageView</span><br><span class="line">    UIViewContentModeScaleAspectFit,</span><br><span class="line">    </span><br><span class="line">    // 图片等比例缩放到 `较短` 一边也填满 UIImageView 为止，多余的裁剪掉</span><br><span class="line">    UIViewContentModeScaleAspectFill, </span><br><span class="line">    </span><br><span class="line">    // 这个不知道是什么鬼</span><br><span class="line">    // 调用 setNeedsDisplay 方法时,就会重新渲染图片</span><br><span class="line">    UIViewContentModeRedraw,</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 不拉伸（压缩）图片，取特定位置，裁剪图片，不变形</span><br><span class="line">    UIViewContentModeCenter,</span><br><span class="line">    //顶部</span><br><span class="line">    UIViewContentModeTop,</span><br><span class="line">    //底部</span><br><span class="line">    UIViewContentModeBottom,</span><br><span class="line">    //左边</span><br><span class="line">    UIViewContentModeLeft,</span><br><span class="line">    //右边</span><br><span class="line">    UIViewContentModeRight,</span><br><span class="line">    //左上</span><br><span class="line">    UIViewContentModeTopLeft,</span><br><span class="line">    //右上</span><br><span class="line">    UIViewContentModeTopRight,</span><br><span class="line">    //左下</span><br><span class="line">    UIViewContentModeBottomLeft,</span><br><span class="line">    //右下</span><br><span class="line">    UIViewContentModeBottomRight,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="iOS开发的一些尺寸规范"><a href="#iOS开发的一些尺寸规范" class="headerlink" title="iOS开发的一些尺寸规范"></a>iOS开发的一些尺寸规范</h1><h2 id="iPhone尺寸规格"><a href="#iPhone尺寸规格" class="headerlink" title="iPhone尺寸规格"></a>iPhone尺寸规格</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iPhone4/4S              320x480    </span><br><span class="line">iPhone5/5C/5S           320x568  </span><br><span class="line">iPhone6/6S/7/8          375x667  </span><br><span class="line">iPhone6P/6SP/7P/8P      414x736  </span><br><span class="line">iPhone X                375x812</span><br></pre></td></tr></table></figure>
<h2 id="LaunchImage-启动图"><a href="#LaunchImage-启动图" class="headerlink" title="LaunchImage 启动图"></a>LaunchImage 启动图</h2><ul>
<li>只适配 iphone 时的启动图如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">640x960.png</span><br><span class="line">640x1136.png</span><br><span class="line">750x1334.png</span><br><span class="line">1125x2436.png</span><br><span class="line">1242x2208.png</span><br></pre></td></tr></table></figure>
<h2 id="icon"><a href="#icon" class="headerlink" title="icon"></a>icon</h2><p><a href="https://icon.wuruihong.com/" target="_blank" rel="noopener"><a href="https://icon.wuruihong.com/" target="_blank" rel="noopener">https://icon.wuruihong.com/</a></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">icon-20-ipad.png</span><br><span class="line">icon-20@2x-ipad.png</span><br><span class="line">icon-20@2x.png</span><br><span class="line">icon-20@3x.png</span><br><span class="line">icon-29-ipad.png</span><br><span class="line">icon-29.png</span><br><span class="line">icon-29@2x-ipad.png</span><br><span class="line">icon-29@2x.png</span><br><span class="line">icon-29@3x.png</span><br><span class="line">icon-40.png</span><br><span class="line">icon-40@2x.png</span><br><span class="line">icon-40@3x.png</span><br><span class="line">icon-50.png</span><br><span class="line">icon-50@2x.png</span><br><span class="line">icon-57.png</span><br><span class="line">icon-57@2x.png</span><br><span class="line">icon-60@2x.png</span><br><span class="line">icon-60@3x.png</span><br><span class="line">icon-72.png</span><br><span class="line">icon-72@2x.png</span><br><span class="line">icon-76.png</span><br><span class="line">icon-76@2x.png</span><br><span class="line">icon-83.5@2x.png</span><br><span class="line">icon-1024.png</span><br></pre></td></tr></table></figure>
<h1 id="iOS系统权限"><a href="#iOS系统权限" class="headerlink" title="iOS系统权限"></a>iOS系统权限</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 保存图片到相册相册 --&gt;   </span><br><span class="line">&lt;key&gt; NSPhotoLibraryAddUsageDescription &lt;/key&gt;   </span><br><span class="line">&lt;string&gt;为了把您涂鸦好的图片保存到相册，需要您提供授权&lt;/string&gt;  </span><br><span class="line">&lt;!-- 获取相册的图片 --&gt;   </span><br><span class="line">&lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问相册&lt;/string&gt;   </span><br><span class="line">&lt;!-- 相机 --&gt;   </span><br><span class="line">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问相机&lt;/string&gt;   </span><br><span class="line">&lt;!-- 麦克风 --&gt;   </span><br><span class="line">&lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问麦克风&lt;/string&gt;   </span><br><span class="line">&lt;!-- 位置 --&gt;   </span><br><span class="line">&lt;key&gt;NSLocationUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问位置&lt;/string&gt;   </span><br><span class="line">&lt;!-- 在使用期间访问位置 --&gt;   </span><br><span class="line">&lt;key&gt;NSLocationWhenInUseUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能在使用期间访问位置&lt;/string&gt;   </span><br><span class="line">&lt;!-- 始终访问位置 --&gt;   </span><br><span class="line">&lt;key&gt;NSLocationAlwaysUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能始终访问位置&lt;/string&gt;   </span><br><span class="line">&lt;!-- 日历 --&gt;   </span><br><span class="line">&lt;key&gt;NSCalendarsUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问日历&lt;/string&gt;   </span><br><span class="line">&lt;!-- 提醒事项 --&gt;   </span><br><span class="line">&lt;key&gt;NSRemindersUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问提醒事项&lt;/string&gt;   </span><br><span class="line">&lt;!-- 运动与健身 --&gt;   </span><br><span class="line">&lt;key&gt;NSMotionUsageDescription&lt;/key&gt; </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问运动与健身&lt;/string&gt;   </span><br><span class="line">&lt;!-- 健康更新 --&gt;   </span><br><span class="line">&lt;key&gt;NSHealthUpdateUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问健康更新 &lt;/string&gt;   </span><br><span class="line">&lt;!-- 健康分享 --&gt;   </span><br><span class="line">&lt;key&gt;NSHealthShareUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问健康分享&lt;/string&gt;   </span><br><span class="line">&lt;!-- 蓝牙 --&gt;   </span><br><span class="line">&lt;key&gt;NSBluetoothPeripheralUsageDescription&lt;/key&gt;   </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问蓝牙&lt;/string&gt;   </span><br><span class="line">&lt;!-- 媒体资料库 --&gt;   </span><br><span class="line">&lt;key&gt;NSAppleMusicUsageDescription&lt;/key&gt;  </span><br><span class="line">&lt;string&gt;App需要您的同意,才能访问媒体资料库&lt;/string&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    


<div>

<div>

<div style="text-align:center;color: #ccc;font-size:14px;">- END -</div>

</div>


</div>

<div>



<img align="center" src="https://liangdahong.com/images/0/mywx.jpeg" width="25%" style="border-radius:5px; box-shadow: 5px 5px 5px #999999"></img>
<div align="center" style="color: #aaaaaa">⌾</div>

<div class="my_post_copyright" style="border-radius:5px; box-shadow: 5px 5px 5px #999999">

<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
<!-- JS库 sweetalert 可修改路径 -->
<script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<p><span>文章作者:</span><a href="/" title="访问 梁大红 的个人博客">梁大红</a></p>
<p><span>特别声明:</span><a href="https://liangdahong.com/about/" title="A">若无特殊声明均为原创，转载请注明，侵权请联系</a></p>
<p><span>版权声明:</span><a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a></p>

</div>

<script>
var clipboard = new Clipboard('.fa-clipboard');
$(".fa-clipboard").click(function(){
clipboard.on('success', function(){
swal({
title: "",
text: '拷贝成功!',
icon: "success",
showConfirmButton: true
});
});
});
</script>



</div>

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"> <i class="fa fa-tag"></i> iOS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/25/00-技术-iOS/NSObject-Runtime-杂货铺/" rel="next" title="NSObject Runtime 杂货铺">
                <i class="fa fa-chevron-left"></i> NSObject Runtime 杂货铺
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/03/00-技术-iOS/OC与JavaScript交互/" rel="prev" title="OC与JavaScript交互">
                OC与JavaScript交互 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpeg"
                alt="梁大红" />
            
              <p class="site-author-name" itemprop="name">梁大红</p>
              <p class="site-description motion-element" itemprop="description">千里之行始于足下</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">44</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/liangdahong" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://weibo.com/liangdahong" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/liangdahong" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/dahong.liang" target="_blank" title="Facebook">
                      
                        <i class="fa fa-fw fa-facebook"></i>Facebook</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:ios@liangdahong.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://nshipster.com" title="Mattt" target="_blank">Mattt</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.ibireme.com" title="ibireme" target="_blank">ibireme</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://onevcat.com" title="onevcat" target="_blank">onevcat</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.cnbang.net/archives" title="bang" target="_blank">bang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.sunnyxx.com" title="sunnyxx" target="_blank">sunnyxx</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.awhisper.net/" title="折腾范儿の味精" target="_blank">折腾范儿の味精</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://jinxiansen.com/" title="晋先森" target="_blank">晋先森</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://haodachuang.cn/" title="乡长" target="_blank">乡长</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#UIView"><span class="nav-number">1.</span> <span class="nav-text">UIView</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#transform-属性"><span class="nav-number">1.1.</span> <span class="nav-text">transform 属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CGAffineTransformMake-变换原理"><span class="nav-number">1.1.1.</span> <span class="nav-text">CGAffineTransformMake 变换原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#系统API说明"><span class="nav-number">1.1.2.</span> <span class="nav-text">系统API说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UIScrollView"><span class="nav-number">2.</span> <span class="nav-text">UIScrollView</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#UIScrollView-1"><span class="nav-number">2.1.</span> <span class="nav-text">UIScrollView</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UIScrollViewDelegate"><span class="nav-number">2.2.</span> <span class="nav-text">UIScrollViewDelegate</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#iOS沙盒"><span class="nav-number">3.</span> <span class="nav-text">iOS沙盒</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#沙盒目录"><span class="nav-number">3.1.</span> <span class="nav-text">沙盒目录</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#appearance"><span class="nav-number">4.</span> <span class="nav-text">appearance</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AFN"><span class="nav-number">5.</span> <span class="nav-text">AFN</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#保存图片到相册"><span class="nav-number">6.</span> <span class="nav-text">保存图片到相册</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#显示模式-UIViewContentMode"><span class="nav-number">7.</span> <span class="nav-text">显示模式 UIViewContentMode</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#iOS开发的一些尺寸规范"><span class="nav-number">8.</span> <span class="nav-text">iOS开发的一些尺寸规范</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iPhone尺寸规格"><span class="nav-number">8.1.</span> <span class="nav-text">iPhone尺寸规格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LaunchImage-启动图"><span class="nav-number">8.2.</span> <span class="nav-text">LaunchImage 启动图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#icon"><span class="nav-number">8.3.</span> <span class="nav-text">icon</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#iOS系统权限"><span class="nav-number">9.</span> <span class="nav-text">iOS系统权限</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>

<span class="author" itemprop="copyrightHolder">梁大红</span>

  
</div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://liangdahong.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://liangdahong.com/2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/';
          this.page.identifier = '2017/05/11/00-技术-iOS/iOS-系统控件的一些用法/';
          this.page.title = 'iOS 系统控件的一些用法';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://liangdahong.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
